# ファイル管理ユーティリティ / File Management Utility

## 概要 / Overview

このアプリケーションは、ファイル名の変更や移動を効率的に行うためのユーティリティツールです。  
日付、連番、カスタムテキストなどを組み合わせたファイル名パターンを作成し、単一または複数のファイルに適用できます。

This application is a utility tool for efficiently renaming and moving files.  
It allows you to create filename patterns combining date, sequence numbers, and custom text, which can be applied to single or multiple files.

---

## システム要件 / System Requirements

- Windows 7以降
- Python 3.7以降
- tkinterdnd2 ライブラリ
- 最小メモリ: 256MB
- ディスク容量: 50MB以上の空き容量

---

## インストールと起動方法 / Installation & Launch

### 依存パッケージのインストール

```bash
pip install pyperclip
pip install tkinterdnd2
```

### 実行方法

```bash
python file_manager.py
```

### EXEファイルの作成（任意）

```bash
pip install pyinstaller
pyinstaller --onefile --noconsole file_manager.py
```

生成された`dist/file_manager.exe`を実行してください。

---

### tkinterDnD2対応版 EXEファイルの作成

`tkinterdnd2`を使用している場合、
通常のPyInstallerコマンドでは`tkdnd`ライブラリが含まれず、
`Unable to load tkdnd library`エラーが発生することがあります。

その場合は、`tkdnd`のDLLやTCLファイルを明示的に含めてビルドしてください。

#### 例: `win-x64`ディレクトリを含める場合

```bash
pyinstaller --onefile --noconsole --add-data "C:/WPy64-31110/python-3.11.1.amd64/Lib/site-packages/tkinterdnd2/tkdnd/win-x64;tkinterdnd2/tkdnd/win-x64" file_manager.py
```

- `--add-data`の前半は`tkdnd`の実体があるディレクトリのパス
- 後半はexe内での配置先（`tkinterdnd2/tkdnd/win-x64`）

これにより、`tkinterdnd2`が`tkdnd`を正しく読み込めるようになります。

---

## 主な機能 / Main Features

- **ファイル名パターン作成**: 日付、連番、カスタムテキストを組み合わせたファイル名パターンを作成
- **テンプレート管理**: よく使うファイル名パターンを保存・読み込み
- **一括処理**: 複数ファイルの名前変更・移動を一度に実行
- **保存先管理**: 頻繁に使用する保存先をテンプレートとして保存
- **自動連番**: コピーや名前変更時に連番を自動増加
- **ショートカットキー**: 主要機能にショートカットキーを割り当て
- **モード切替**: かんたんモードと詳細モードの切替が可能
- **ドラッグ＆ドロップ対応**: ウィンドウにファイルをドラッグ＆ドロップして選択・名前変更が可能
- **ファイル名コンポーネント編集**: ファイル名に挿入する日付・連番・カスタムテキストの設定
- **プロファイル管理**: ファイル名パターンと保存先のセットを複数保存・呼び出し可能

---

## 使い方 / How to Use

### モード切替と表示切替

画面上部の「モード切替」チェックボックスで、  
**かんたんモード**（単一ファイル向け）と  
**詳細モード**（一括処理向け）を切り替えられます。

また、モード切替の横にある  
- **ファイル名コンポーネント表示**  
- **プロファイル管理表示**  
のチェックボックスで、それぞれのタブの表示/非表示を切り替えられます。

---

### 基本操作タブ

- ファイルの選択、保存先の指定、名前変更・移動などの操作を行います。
- ファイル名パターンのプレビューやテンプレートの保存・呼び出しもここで行います。
- 一括処理モードに切り替えると複数ファイルの操作が可能です。

---

### ファイル名コンポーネントタブ

- ファイル名に挿入する**日付フォーマット**、**連番**、**カスタムテキスト**、**区切り文字**を設定できます。
- 「日付を挿入」「連番を挿入」「テキストを挿入」ボタンでパターンに追加可能。
- 設定内容は「基本操作」タブのファイル名パターンに反映されます。

---

### プロファイル管理タブ

- ファイル名パターンと保存先のセットを**プロファイル**として保存・呼び出しできます。
- よく使う設定を複数登録しておくことで、作業の効率化が図れます。

---

### ファイルの選択と操作

- **単一ファイルの場合**  
  「ファイル参照」ボタンでファイルを選択、  
  またはウィンドウにファイルをドラッグ＆ドロップして選択

- **一括処理の場合**  
  「一括処理モード」にチェックを入れ、  
  「ファイル追加」で複数ファイルを選択、  
  「選択削除」「すべて削除」で管理

- **送り先フォルダの指定**  
  「ファイルの送り先」欄にフォルダをドラッグ＆ドロップして指定、  
  または「参照」ボタンで選択

- **操作ボタン**  
  - 名前コピー (Ctrl+C)  
  - ファイル名変更 (Ctrl+R)  
  - ファイル移動 (Ctrl+M)  
  - 名前変更＆移動 (Ctrl+Shift+M)

---

## ショートカットキー一覧 / Shortcut Keys

| キー             | 機能                          |
|------------------|-------------------------------|
| F5               | プレビュー更新                |
| Ctrl+C           | クリップボードにコピー        |
| Ctrl+R           | ファイル名変更                |
| Ctrl+M           | ファイル移動                  |
| Ctrl+Shift+M     | 名前変更＆移動                |
| Ctrl+O           | ファイル選択                  |
| Ctrl+D           | 保存先選択                    |
| Ctrl+S           | テンプレート保存              |
| Ctrl+L           | テンプレート読込              |

---

## トラブルシューティング / Troubleshooting

- **設定ファイルが保存されない**  
  実行ファイルと同じフォルダに書き込み権限があるか確認してください。

- **ファイル操作ができない**  
  ファイルのアクセス権限を確認してください。

- **日本語が文字化けする**  
  システムの言語設定を確認してください。

---

## ライセンス / License

MIT License

---

## 作者 / Author

[inata169]  
最終更新: 2025年4月9日
---

## ファイル名パターン一覧とコンポーネント編集

- 基本操作タブの「ファイル名パターン一覧」から任意のパターンをダブルクリックすると、
  別ウィンドウでファイル名コンポーネント（日付・連番・カスタムテキストなど）の詳細設定が可能です。

